#version: 2.1
#jobs:
#  test:
#    docker:
#      - image: <your_user_name>/tutorial_ci
#    steps:
#      - checkout
#      - run:
#         name: Setup Code Climate test-reporter
#         command: |
#          # download test reporter as a static binary
#            curl -L https://codeclimate.com/downloads/test-reporter/test-reporter-latest-linux-amd64 > ./cc-test-reporter
#            chmod +x ./cc-test-reporter
#            ./cc-test-reporter before-build
#      - run:
#          name: Run tests
#          command: |
#            python -m pytest --cov-report xml --cov-report term --cov .
#      - run:
#          name: Send coverage to Code Climate
#          command: |
#            ./cc-test-reporter after-build --exit-code $?
#workflows:
#  test:
#    jobs:
#      - test


name: pytest
on: push
jobs:
  push:
    runs-on: ubuntu-latest
    steps:
      - name: checkout repo
        uses: actions/checkout@v2
      - name: Install Dependencies
        run: |
          pip install pytest
          pip install pytest-cov
      # - uses: paambaati/codeclimate-action@v3.0.0

      - name: Create Reporter
        run: |
          - curl -L https://codeclimate.com/downloads/test-reporter/test-reporter-latest-linux-amd64 > ./cc-test-reporter
          - chmod +x ./cc-test-reporter
          - ./cc-test-reporter before-build
      - name: Test
        run: |
          - pytest --cov-report term-missing --cov=gendiff
      - name: Sending Reporter
          - pytest --cov-report xml:cov.xml
          - ./cc-test-reporter after-build

